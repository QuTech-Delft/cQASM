/** \file
 * Contains helper classes and objects for the lexer and parser generated by
 * flex/bison, as well as the entry points for invoking the parser directly, in
 * case you don't need semantic analysis.
 */

#pragma once

#include "cqasm-annotations.hpp"
#include "cqasm-ast.hpp"

#include <string>
#include <vector>


/**
 * Namespace for the parser functions and classes.
 */
namespace cqasm::v1x::parser {

/**
 * Parse result information.
 */
class ParseResult {
public:
    /**
     * Root node of the AST, if analysis was sufficiently successful.
     * This may be set even if parsing was not ENTIRELY successful,
     * in which case it will contain one or more error nodes.
     */
    ast::One<ast::Root> root;

    /**
     * List of accumulated errors.
     * Analysis was successful if and only if errors.empty().
     */
    std::vector<std::string> errors;

    /**
     * Returns a vector of strings, of which the first is reserved for the CBOR serialization of the v1.x syntactic AST.
     * Any additional strings represent error messages.
     * Notice that the AST and error messages won't be available at the same time.
     */
    [[nodiscard]] std::vector<std::string> to_strings() const;

    /**
     * Returns a string with a JSON representation of a ParseResult.
     */
    std::string to_json() const;
};

} // namespace cqasm::v1x::parser
